# Cosmo Router Configuration
version: "1"

# Router configuration
graph:
  # For local development without Cosmo Studio
  mode: offline
  
# Server settings
server:
  listen_addr: "0.0.0.0:4000" # Different port from current gateway
  playground: true
  introspection: true
  
# CORS configuration
cors:
  allow_origins:
    - "http://localhost:3001"
    - "http://localhost:5173"
  allow_methods:
    - GET
    - POST
  allow_headers:
    - Content-Type
    - Authorization
  allow_credentials: true

# Subscription configuration
subscriptions:
  enabled: true
  # Prefer SSE over WebSocket
  protocols:
    - sse
    - graphql-ws
  
# SSE specific configuration  
sse:
  enabled: true
  keep_alive_interval: 30s
  
# Subgraph configuration
subgraphs:
  - name: claude
    routing_url: "http://localhost:3002/graphql"
    subscription_url: "http://localhost:3002/graphql/stream"
    subscription_protocol: "sse"
    
  - name: git
    routing_url: "http://localhost:3004/graphql"
    subscription_url: "http://localhost:3004/graphql/stream"
    subscription_protocol: "sse"
    
  - name: github
    routing_url: "http://localhost:3005/graphql"
    # No subscriptions for GitHub adapter
    
# Telemetry and monitoring
telemetry:
  metrics:
    prometheus:
      enabled: true
      listen_addr: "0.0.0.0:8088"
      path: "/metrics"
  
  tracing:
    enabled: true
    sampling_rate: 1.0 # 100% for development
    
# Performance settings
performance:
  query_depth_limit: 15
  max_upload_size: 10MB
  request_timeout: 30s
  
# Logging
log:
  level: info
  format: json
  
# Health check
health_check:
  enabled: true
  path: "/health"
  
# Rate limiting
rate_limit:
  enabled: true
  rate: 100
  burst: 200
  window: 1m